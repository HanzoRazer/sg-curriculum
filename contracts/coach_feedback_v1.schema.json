{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "sg-curriculum://contracts/coach_feedback_v1",
  "title": "Coach Feedback v1",
  "description": "Structured coaching output; no prompt traces by default.",
  "type": "object",
  "additionalProperties": false,
  "required": ["schema_id", "schema_version", "created_at_utc", "device_learner_id", "session_id", "feedback"],
  "properties": {
    "schema_id": { "type": "string", "const": "coach_feedback" },
    "schema_version": { "type": "string", "const": "v1" },
    "created_at_utc": { "type": "string", "format": "date-time" },
    "device_learner_id": { "type": "string", "minLength": 6, "maxLength": 128 },
    "session_id": { "type": "string", "minLength": 6, "maxLength": 128 },
    "feedback": {
      "type": "object",
      "additionalProperties": false,
      "required": ["observations", "next_steps", "confidence"],
      "properties": {
        "observations": { "type": "array", "items": { "type": "string", "minLength": 1, "maxLength": 240 }, "maxItems": 24 },
        "next_steps": { "type": "array", "items": { "type": "string", "minLength": 1, "maxLength": 240 }, "maxItems": 24 },
        "warnings": { "type": "array", "items": { "type": "string", "minLength": 1, "maxLength": 240 }, "maxItems": 12 },
        "rubric_tags": { "type": "array", "items": { "type": "string", "minLength": 1, "maxLength": 32 }, "maxItems": 24 },
        "confidence": { "type": "number", "minimum": 0, "maximum": 1 },
        "policy_version": { "type": "string", "minLength": 1, "maxLength": 32 }
      }
    }
  }
}
